# RuoYi-Vue3-FastAPI 快速开发指南

## 📋 项目概述

RuoYi-Vue3-FastAPI 是一个基于 Vue3 + FastAPI 的企业级快速开发框架，采用前后端分离架构，提供完整的权限管理、代码生成、系统监控等功能。

### 🏗️ 技术栈

| 层级 | 技术 | 版本 |
|------|------|------|
| 前端 | Vue3 + Element Plus + Vite + Pinia | 最新稳定版 |
| 后端 | FastAPI + SQLAlchemy + MySQL/PostgreSQL | 最新稳定版 |
| 认证 | OAuth2 + JWT | - |
| 缓存 | Redis | - |
| 构建 | Vite (前端) + Uvicorn (后端) | - |

### 🎯 核心特性

- ✅ **完整的权限管理系统** - 用户、角色、菜单、部门管理
- ✅ **代码生成器** - 一键生成前后端代码
- ✅ **在线表单构建器** - 可视化表单设计
- ✅ **系统监控** - CPU、内存、磁盘监控
- ✅ **定时任务** - 在线任务调度管理
- ✅ **文件上传** - 支持多种文件格式
- ✅ **多数据库支持** - MySQL、PostgreSQL
- ✅ **API文档** - 自动生成接口文档

## 🚀 快速启动

### 1. 环境准备

确保您的开发环境满足以下要求：

```bash
# 系统要求
- Python ≥ 3.9
- Node.js ≥ 16
- MySQL ≥ 5.7 或 PostgreSQL
- Redis
```

### 2. 数据库配置

#### MySQL 配置 (推荐)

```sql
-- 创建数据库
CREATE DATABASE `ruoyi-fastapi` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 导入数据 (在项目根目录执行)
mysql -u root -p ruoyi-fastapi < ruoyi-fastapi-backend/sql/ruoyi-fastapi.sql
```

#### PostgreSQL 配置

```sql
-- 创建数据库
createdb ruoyi-fastapi

-- 导入数据 (在项目根目录执行)
psql -U postgres -d ruoyi-fastapi -f ruoyi-fastapi-backend/sql/ruoyi-fastapi-pg.sql
```

### 3. 后端启动

```bash
# 进入后端目录
cd ruoyi-fastapi-backend

# 创建虚拟环境
python3 -m venv venv

# 激活虚拟环境
source venv/bin/activate  # Linux/Mac
# 或
venv\Scripts\activate     # Windows

# 安装依赖
pip install -r requirements.txt

# 配置环境变量 (修改 .env.dev 文件)
# 主要配置项：
# - 数据库连接信息
# - Redis连接信息
# - JWT密钥

# 启动后端服务
python3 app.py --env=dev
```

### 4. 前端启动

```bash
# 进入前端目录
cd ruoyi-fastapi-frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

### 5. 访问系统

- **前端地址**: http://localhost:80
- **后端API**: http://localhost:9099
- **默认账号**: admin
- **默认密码**: admin123

## 📁 项目结构

```
RuoYi-Vue3-FastAPI/
├── ruoyi-fastapi-frontend/          # Vue3前端项目
│   ├── src/
│   │   ├── api/                     # API接口定义
│   │   ├── components/              # 公共组件
│   │   ├── layout/                  # 布局组件
│   │   ├── router/                  # 路由配置
│   │   ├── store/                   # 状态管理 (Pinia)
│   │   ├── utils/                   # 工具函数
│   │   └── views/                   # 页面组件
│   ├── public/                      # 静态资源
│   └── package.json
├── ruoyi-fastapi-backend/           # FastAPI后端项目
│   ├── config/                      # 配置文件
│   │   ├── env.py                   # 环境配置
│   │   ├── database.py              # 数据库配置
│   │   └── constant.py              # 常量定义
│   ├── module_admin/                # 管理模块
│   │   ├── controller/              # 控制器层
│   │   ├── dao/                     # 数据访问层
│   │   ├── entity/                  # 实体模型
│   │   └── service/                 # 业务逻辑层
│   ├── module_generator/            # 代码生成模块
│   ├── module_task/                 # 定时任务模块
│   ├── sql/                         # 数据库脚本
│   └── requirements.txt
└── README.md
```

## 🔧 开发指南

### 1. 添加新功能模块

#### 后端开发流程

1. **创建实体模型** (`module_admin/entity/`)
```python
from sqlalchemy import Column, Integer, String, DateTime
from config.database import Base

class YourEntity(Base):
    __tablename__ = 'your_table'
    
    id = Column(Integer, primary_key=True, autoincrement=True)
    name = Column(String(100), nullable=False, comment='名称')
    create_time = Column(DateTime, comment='创建时间')
```

2. **创建DAO层** (`module_admin/dao/`)
```python
from module_admin.entity.your_entity import YourEntity
from config.database import get_db

class YourDao:
    def __init__(self):
        self.db = get_db()
    
    async def get_list(self, **kwargs):
        # 查询逻辑
        pass
```

3. **创建Service层** (`module_admin/service/`)
```python
from module_admin.dao.your_dao import YourDao

class YourService:
    def __init__(self):
        self.dao = YourDao()
    
    async def get_list(self, **kwargs):
        return await self.dao.get_list(**kwargs)
```

4. **创建Controller层** (`module_admin/controller/`)
```python
from fastapi import APIRouter, Depends
from module_admin.service.your_service import YourService

router = APIRouter(prefix="/your", tags=["Your模块"])

@router.get("/list")
async def get_list(service: YourService = Depends()):
    return await service.get_list()
```

#### 前端开发流程

1. **创建API接口** (`src/api/`)
```javascript
import request from '@/utils/request'

export function getYourList(params) {
  return request({
    url: '/your/list',
    method: 'get',
    params
  })
}
```

2. **创建页面组件** (`src/views/`)
```vue
<template>
  <div class="your-page">
    <!-- 页面内容 -->
  </div>
</template>

<script setup>
import { getYourList } from '@/api/your'

// 组件逻辑
</script>
```

3. **添加路由配置** (`src/router/`)
```javascript
{
  path: '/your',
  component: Layout,
  children: [
    {
      path: 'list',
      component: () => import('@/views/your/index.vue'),
      name: 'YourList',
      meta: { title: 'Your列表', icon: 'list' }
    }
  ]
}
```

### 2. 使用代码生成器

1. **配置数据库表**
   - 在数据库中创建表结构
   - 确保表名以 `sys_` 开头（可配置）

2. **使用代码生成器**
   - 访问系统管理 → 代码生成
   - 导入数据库表
   - 配置生成参数
   - 生成代码并下载

3. **集成生成的代码**
   - 将生成的后端代码复制到对应目录
   - 将生成的前端代码复制到对应目录
   - 配置路由和权限

### 3. 权限管理

#### 菜单权限
- 在系统管理 → 菜单管理中配置菜单
- 设置菜单权限标识
- 配置按钮权限

#### 数据权限
- 在角色管理中设置数据范围
- 支持全部数据、本部门数据、本部门及以下数据、自定义数据

### 4. 常用开发技巧

#### 后端开发技巧

1. **使用依赖注入**
```python
from fastapi import Depends
from module_admin.service.user_service import UserService

@router.get("/users")
async def get_users(service: UserService = Depends()):
    return await service.get_list()
```

2. **统一响应格式**
```python
from utils.response import success_response

@router.get("/data")
async def get_data():
    return success_response(data={"message": "success"})
```

3. **参数验证**
```python
from pydantic import BaseModel

class YourRequest(BaseModel):
    name: str
    age: int

@router.post("/create")
async def create(data: YourRequest):
    # 处理请求
    pass
```

#### 前端开发技巧

1. **使用组合式API**
```vue
<script setup>
import { ref, onMounted } from 'vue'
import { useRequest } from '@/hooks/useRequest'

const { data, loading, run } = useRequest(getYourList)

onMounted(() => {
  run()
})
</script>
```

2. **状态管理**
```javascript
// store/modules/your.js
import { defineStore } from 'pinia'

export const useYourStore = defineStore('your', {
  state: () => ({
    list: [],
    loading: false
  }),
  actions: {
    async fetchList() {
      this.loading = true
      try {
        const res = await getYourList()
        this.list = res.data
      } finally {
        this.loading = false
      }
    }
  }
})
```

## 🛠️ 部署指南

### 开发环境部署

```bash
# 后端
cd ruoyi-fastapi-backend
source venv/bin/activate
python3 app.py --env=dev

# 前端
cd ruoyi-fastapi-frontend
npm run dev
```

### 生产环境部署

```bash
# 后端
cd ruoyi-fastapi-backend
source venv/bin/activate
python3 app.py --env=prod

# 前端
cd ruoyi-fastapi-frontend
npm run build:prod
# 将 dist 目录部署到 Web 服务器
```

## 📚 常用命令

```bash
# 后端相关
python3 app.py --env=dev          # 启动开发环境
python3 app.py --env=prod         # 启动生产环境
pip install -r requirements.txt    # 安装依赖

# 前端相关
npm run dev                       # 启动开发服务器
npm run build:prod               # 构建生产版本
npm run build:stage              # 构建测试版本
npm install                      # 安装依赖
```

## 🔍 常见问题

### 1. 数据库连接失败
- 检查数据库服务是否启动
- 验证数据库连接配置
- 确认数据库用户权限

### 2. Redis连接失败
- 检查Redis服务是否启动
- 验证Redis连接配置
- 确认Redis密码设置

### 3. 前端API请求失败
- 检查后端服务是否启动
- 验证API代理配置
- 确认跨域设置

### 4. 权限验证失败
- 检查JWT配置
- 验证用户登录状态
- 确认权限配置

## 📞 技术支持

- **项目地址**: https://gitee.com/insistence2022/RuoYi-Vue3-FastAPI
- **在线演示**: https://vfadmin.insistence.tech
- **文档地址**: 项目README.md

## 🎉 开始开发

现在您已经了解了项目的基本结构和开发流程，可以开始您的快速开发之旅了！

记住：
1. 先配置好数据库和Redis
2. 启动后端和前端服务
3. 使用默认账号登录系统
4. 熟悉各个功能模块
5. 使用代码生成器快速开发新功能

祝您开发愉快！🚀